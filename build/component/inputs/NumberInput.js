import{Input as t}from"../core/Input.js";import{b as e}from"../Utils-eb9561bf.js";class s extends t{constructor(t=0,s=-1/0,i=1/0,n=.01){const r=document.createElement("input");super(r),this.min=s,this.max=i,this.step=n,this.integer=!1,r.type="text",r.className="number",r.value=this._getString(t),r.spellcheck=!1,r.autocomplete="off",r.ondragstart=r.oncontextmenu=t=>{t.preventDefault(),t.stopPropagation()},r.onfocus=r.onclick=()=>{r.select()},r.onblur=()=>{this.dom.value=this._getString(this.dom.value),this.dispatchEvent(new Event("blur"))},r.onchange=()=>{this.dispatchEvent(new Event("change"))},r.onkeydown=t=>{if(1===t.key.length&&!0!==/\d|\./.test(t.key))return!1;13===t.keyCode&&t.target.blur(),t.stopPropagation()},e(r,(t=>{const{delta:e}=t;if(!0===r.readOnly)return;void 0===t.value&&(t.value=this.getValue());const s=e.x-e.y,i=t.value+s*this.step;r.value=this._getString(i.toFixed(this.precision)),this.dispatchEvent(new Event("change"))}))}setStep(t){return this.step=t,this}setRange(t,e,s){return this.min=t,this.max=e,this.step=s,this.dispatchEvent(new Event("range")),this.setValue(this.getValue())}get precision(){if(!0===this.integer)return 0;const t=this.step%1;return 0!==t?t.toString().split(".")[1].length:1}setValue(t,e=!0){return super.setValue(this._getString(t),e)}getValue(){return Number(this.dom.value)}serialize(t){const{min:e,max:s}=this;e!==-1/0&&s!==1/0&&(t.min=this.min,t.max=this.max,t.step=this.step),super.serialize(t)}deserialize(t){if(void 0!==t.min){const{min:t,max:e,step:s}=this;this.setRange(t,e,s)}super.deserialize(t)}_getString(t){const e=Math.min(Math.max(Number(t),this.min),this.max);return!0===this.integer?Math.floor(e):e+(e%1?"":".0")}}export{s as NumberInput};
